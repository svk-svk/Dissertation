# Unsupervised Learning Techniques for Anomaly Detection in Lateral Movement

## Abstract
#### This project explores the application of unsupervised machine learning algorithms to detect lateral movement in computer networks on the PicoDomain dataset on the Kerberos protocol. Lateral movement represent a phase in a cyber attacks where attackers move through a network to access sensitive data or critical infrastructure. I implemented two heuristic approaches and tuning systems for the Isolation Forest and Prophet algorithms using CPU resources. The evaluation shows that these methods effectively identify anomalous behaviors indicative of lateral movement, with Isolation Forest excelling in high-dimensional data environments and Prophet accurately capturing temporal patterns. The results show the potential of unsupervised learning algorithms in improving cyber security measures by providing robust and scalable solutions for anomaly detection.

## [PicoDomain Dataset](https://github.com/iHeartGraph/PicoDomain)

#### I chose the PicoDomain dataset because many existing cybersecurity datasets lack important information of the steps that involve the generating of  the data or use strong anonymized data. The dataset generated by Pico uses Zeek log which has advanced tools and methods for network logging. The simulation made for this dataset, although it is made on the traffic flow of a small enterprise network, it represents a scenario that can happen in practice.

## Algorithms:

### [Fail Login](./1_fail_login.py)
- Fail Login is a rule-based heuristic which considers all failed login events anomalies. 

### [Unknown Authentification](./2_unknow_auth.py)
- Unknown Authentification is a traditional rule-based heuristic that consider all first-time  authentication events as anomalies.

### [Isolation Forest](./3_iforest.py)

- Isolation Forest is an unsupervised machine learning algorithm primarily used for anomaly 
detection. The core concept behind Isolation Forest is that anomalies are rare and distinct, 
showing up more easily than ordinary data.

### [Prophet](./4_prophet.py)

- Prophet is an open-source tool developed Meta, is designed for producing high-quality time  series forecasting. It`s ideal for data with seasonality, trends, and events like holidays.


### [One Class SVM](./5_one_class_svm.py)

- One-Class SVM is an unsupervised machine learning algorithm. The One-Class SVM learns the structure of normal data and then classifies any deviation as an anomaly.


## Best results: 

| Algorithm                | Precison | Recall | Anomalies found |
|--------------------------|----------|-----|-----------------|
| Fail Login               | 0.01     | 0.2 | 171             |
| Unknown Authentification | 0.1      | 0.8 | 78              |
| Isolation Forest         | 0.11     | 1   | 84              | 
| One-Class SVM            | 0.07     | 0.4 | 53              |
| Prophet                  | 0.04     | 0.4 | 98              | 
